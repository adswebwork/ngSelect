/*! ngSelect
version: 0.2.0-pre
build date: 2014-03-19
author: Robin Fan
https://github.com/pc035860/ngSelect.git */
angular.module("ngSelect",[]).controller("NgSelectCtrl",["$scope",function(){function a(){var a;if(b.multiple)a=d.getModel(),angular.isArray(a)?a.length=0:a=[],angular.forEach(f,function(b){b.selected&&a.push(b.value)});else{a=null;var c,e,g;for(c=0,e=f.length;e>c;c++)if(g=f[c],g.selected){a=g.value;break}}d.setModel(a)}var b,c,d=this,e=0,f=[],g=!1;d.init=function(a,e){e=angular.extend({multiple:!1},e),b=e,c=a,c.$render=d.render,g&&(g=!1,d.render())},d.getConfig=function(){return b},d.addOption=function(a){var c={index:e++,value:a,selected:!1};if(b.multiple){var g=d.getModel();angular.isArray(g)&&(c.selected=d.getModel().indexOf(a)>=0)}else c.selected=a==d.getModel();return f.push(c),c},d.updateOption=function(b,c){b.value=c,a()},d.removeOption=function(a){a.selected&&d.unselect(a);var b,c,e;for(b=0,c=f.length;c>b;b++)if(e=f[b],angular.equals(a,e)){f.splice(b,1);break}},d.select=function(c){c.selected=!0,b.multiple||angular.forEach(f,function(a){a.index!==c.index&&(a.selected=!1)}),a()},d.unselect=function(c){b.multiple&&(c.selected=!1,a())},d.clear=function(){if(b.multiple){var a=d.getModel();angular.isArray(a)?a.length=0:d.setModel([])}else d.setModel(null)},d.setModel=function(a){c.$setViewValue(a)},d.getModel=function(){return c.$modelValue},d.render=function(){if(angular.isUndefined(b))return void(g=!0);if(b.multiple){var a=d.getModel();angular.forEach(f,function(b){for(var c=!1,d=0;d<a.length;d++)if(a[d]===b.value){c=!0;break}b.selected=c})}else{var c=!1;angular.forEach(f,function(a){c||a.value!=d.getModel()?a.selected=!1:(a.selected=!0,c=!0)})}}}]).directive("ngSelect",[function(){return{restrict:"A",controller:"NgSelectCtrl",require:"ngModel",link:function(a,b,c,d){var e=b.data("$ngSelectController"),f={};f.multiple=function(){return angular.isUndefined(c.selectMultiple)?!1:""===c.selectMultiple||1===Number(c.selectMultiple)}(),f.classExpr=c.selectClass,f.disabledExpr=c.selectDisabled,f.styleExpr=c.selectStyle,e.init(d,f)}}}]).directive("ngSelectOption",[function(){return{restrict:"A",require:"^ngSelect",link:function(a,b,c,d){function e(a){m=c.selectClass||a.classExpr,l=c.selectDisabled||a.disabledExpr,n=c.selectStyle||a.styleExpr}function f(a){var b={},c=function(a){return a=a.toLowerCase(),a.charAt(0).toUpperCase()+a.slice(1)};return angular.forEach(a,function(a,d){b["$opt"+c(d)]=a}),b}function g(a){var b=f(a);return b.$optDisabled=h(a),b}function h(b){return l&&a.$eval(l,f(b))}function i(a,c){c&&a!==c&&angular.forEach(c,function(a,c){b.css(c,"")}),a&&b.css(a)}function j(a,c){var d=function(a,b){var c=[];return angular.forEach(a,function(a,d){var e=b(a,d);e&&c.push(e)}),c},e=function(a){angular.isObject(a)&&!angular.isArray(a)&&(a=d(a,function(a,b){return a?b:void 0})),b.removeClass(angular.isArray(a)?a.join(" "):a)},f=function(a){angular.isObject(a)&&!angular.isArray(a)&&(a=d(a,function(a,b){return a?b:void 0})),a&&b.addClass(angular.isArray(a)?a.join(" "):a)};c&&!angular.equals(a,c)&&e(c),f(a)}var k,l,m,n;e(d.getConfig()),a.$on("$destroy",function(){angular.isDefined(k)&&d.removeOption(k)}),c.$observe("ngSelectOption",function(c,e){angular.isDefined(c)&&c!==e&&(angular.isUndefined(k)?(k=d.addOption(a.$eval(c)),b.bind("click",function(){return h(k)||a.$apply(function(){d[k.selected?"unselect":"select"](k)}),!1}),a.$watch(function(a){return a.$eval(m,g(k))},j,!0),a.$watch(function(a){return a.$eval(n,g(k))},i,!0)):d.updateOption(k,c))})}}}]);